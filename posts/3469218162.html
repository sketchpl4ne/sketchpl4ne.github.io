<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="what is MCP?定义MCP 是一个开放协议，它规范了应用程序向 LLM 提供上下文的方式。MCP 就像 AI 应用程序的 USB-C 端口一样，如下图所示。正如 USB-C 提供了一种标准化的方式将您的设备连接到各种外围设备和配件一样，MCP 也提供了一种标准化的方式将 AI 模型连接到不同的数据源和工具。 架构MCP架构中一般包含下面5个组件：  Host：用户操作的主机，搭载了MCP">
<meta property="og:type" content="article">
<meta property="og:title" content="MCP基础知识">
<meta property="og:url" content="https://jaspersec.top/posts/3469218162.html">
<meta property="og:site_name" content="Jasper_sec">
<meta property="og:description" content="what is MCP?定义MCP 是一个开放协议，它规范了应用程序向 LLM 提供上下文的方式。MCP 就像 AI 应用程序的 USB-C 端口一样，如下图所示。正如 USB-C 提供了一种标准化的方式将您的设备连接到各种外围设备和配件一样，MCP 也提供了一种标准化的方式将 AI 模型连接到不同的数据源和工具。 架构MCP架构中一般包含下面5个组件：  Host：用户操作的主机，搭载了MCP">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/cf2b4a0ffb038387c4dbce54920223c1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/dd668f394c19b4af749386e8a0281df4.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/c1a213475c9d423f91ccc2f3455f8de7.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/36bec2b148637723165ed9d633a7d980.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/3783bd9dcddb9b9ce0f32890c7e2b95a.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/c6078f268f5f42035a408d23d5e25efb.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/10073980eba815ca9155a758e22a1a63.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/6f63e0dee568c1042b6ec94a1440fb79.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/c8ec02698451d228cd593b9e0ccc57ad.svg">
<meta property="article:published_time" content="2025-05-25T16:37:00.000Z">
<meta property="article:modified_time" content="2025-05-25T16:37:39.146Z">
<meta property="article:author" content="Jasper_sec">
<meta property="article:tag" content="MCP">
<meta property="article:tag" content="AI">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/cf2b4a0ffb038387c4dbce54920223c1.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon1.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon1-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon1.png">
        
      
    
    <!-- title -->
    <title>MCP基础知识</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/true" title="Jasper_sec" type="application/atom+xml" />
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/sketchpl4ne">Projects</a></li><!--
     --><!--
       --><li><a href="/HTML/links.html">links</a></li><!--
     --><!--
       --><li><a href="/HTML/about.html">About</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span> 
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/posts/1237655284.html"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://jaspersec.top/posts/3469218162.html"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://jaspersec.top/posts/3469218162.html&text=MCP基础知识"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://jaspersec.top/posts/3469218162.html&title=MCP基础知识"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://jaspersec.top/posts/3469218162.html&is_video=false&description=MCP基础知识"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=MCP基础知识&body=Check out this article: https://jaspersec.top/posts/3469218162.html"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://jaspersec.top/posts/3469218162.html&title=MCP基础知识"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://jaspersec.top/posts/3469218162.html&title=MCP基础知识"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://jaspersec.top/posts/3469218162.html&title=MCP基础知识"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://jaspersec.top/posts/3469218162.html&title=MCP基础知识"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://jaspersec.top/posts/3469218162.html&name=MCP基础知识&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://jaspersec.top/posts/3469218162.html&t=MCP基础知识"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <!-- 
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#what-is-MCP"><span class="toc-number">1.</span> <span class="toc-text">what is MCP?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89"><span class="toc-number">1.1.</span> <span class="toc-text">定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6"><span class="toc-number">1.3.</span> <span class="toc-text">通信机制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Why-MCP"><span class="toc-number">2.</span> <span class="toc-text">Why MCP?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E4%BC%A0%E7%BB%9FLLM%E5%AF%B9%E6%AF%94"><span class="toc-number">2.1.</span> <span class="toc-text">与传统LLM对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8EFunction-Calling%E5%AF%B9%E6%AF%94"><span class="toc-number">2.2.</span> <span class="toc-text">与Function Calling对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MCP-quick-start"><span class="toc-number">3.</span> <span class="toc-text">MCP quick start</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-MCP-works"><span class="toc-number">4.</span> <span class="toc-text">How MCP works</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">6.</span> <span class="toc-text">Reference</span></a></li></ol>
      </div>
     -->
    <div id="toc">
      <div id="toc-div" class="toc-article" >
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#what-is-MCP"><span class="toc-number">1.</span> <span class="toc-text">what is MCP?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89"><span class="toc-number">1.1.</span> <span class="toc-text">定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6"><span class="toc-number">1.3.</span> <span class="toc-text">通信机制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Why-MCP"><span class="toc-number">2.</span> <span class="toc-text">Why MCP?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E4%BC%A0%E7%BB%9FLLM%E5%AF%B9%E6%AF%94"><span class="toc-number">2.1.</span> <span class="toc-text">与传统LLM对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8EFunction-Calling%E5%AF%B9%E6%AF%94"><span class="toc-number">2.2.</span> <span class="toc-text">与Function Calling对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MCP-quick-start"><span class="toc-number">3.</span> <span class="toc-text">MCP quick start</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-MCP-works"><span class="toc-number">4.</span> <span class="toc-text">How MCP works</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">6.</span> <span class="toc-text">Reference</span></a></li></ol>
        
      </div>
    </div>
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        MCP基础知识
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Jasper_sec</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-05-25T16:37:00.000Z" class="dt-published" itemprop="datePublished">2025-05-26</time>
        
        (Updated: <time datetime="2025-05-25T16:37:39.146Z" class="dt-updated" itemprop="dateModified">2025-05-26</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/AI/" rel="tag">AI</a>, <a class="p-category" href="/tags/MCP/" rel="tag">MCP</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="what-is-MCP"><a href="#what-is-MCP" class="headerlink" title="what is MCP?"></a>what is MCP?</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>MCP 是一个开放协议，它规范了应用程序向 LLM 提供上下文的方式。MCP 就像 AI 应用程序的 USB-C 端口一样，如下图所示。正如 USB-C 提供了一种标准化的方式将您的设备连接到各种外围设备和配件一样，MCP 也提供了一种标准化的方式将 AI 模型连接到不同的数据源和工具。</p>
<h3 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h3><p>MCP架构中一般包含下面5个组件：</p>
<ul>
<li>Host：用户操作的主机，搭载了MCP Client，并且具备访问LLM的能力，如Cursor、vscode cline等</li>
<li>LLM：即大语言模型，主要负责处理用户输入、选择MCP tools、处理返回结果等</li>
<li>MCP Client：MCP的客户端，功能包括：查询Server端可用的tools，调用Server端指定tool等</li>
<li>MCP Server：MCP的服务端，核心功能，将数据源的API封装成tools，供Client调用</li>
<li>Data Source：即数据源，MCP功能之一是建立数据源与大模型之间的桥梁，例如：数据库、本地文件系统、高德地图等<br><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/cf2b4a0ffb038387c4dbce54920223c1.png"></li>
</ul>
<h3 id="通信机制"><a href="#通信机制" class="headerlink" title="通信机制"></a>通信机制</h3><p>MCP 协议支持两种主要的 <a target="_blank" rel="noopener" href="https://modelcontextprotocol.io/docs/concepts/transports">通信机制</a> ：基于stdio的本地通信、基于SSE的远程通信。</p>
<p>这两种机制都使用 <a href="https://link.zhihu.com/?target=https://www.jsonrpc.org/specification">JSON-RPC 2.0</a> 格式进行消息传输，确保了通信的标准化和可扩展性。</p>
<ul>
<li>本地通信：通过 stdio 传输数据，适用于在同一台机器上运行的客户端和服务器之间的通信。</li>
<li>远程通信：利用 SSE 与 HTTP 结合，实现跨网络的实时数据传输，适用于需要访问远程资源或分布式部署的场景。</li>
</ul>
<h2 id="Why-MCP"><a href="#Why-MCP" class="headerlink" title="Why MCP?"></a>Why MCP?</h2><p>谈到MCP的优势，一般分为两个对比方向：与传统LLM对比、与Function Calling对比。</p>
<h3 id="与传统LLM对比"><a href="#与传统LLM对比" class="headerlink" title="与传统LLM对比"></a>与传统LLM对比</h3><p>传统LLM的数据基于预训练的预料，模型的知识具有滞后性，在MCP之前的解决方式一般为添加额外数据源，如：联网搜索、本地知识库等。这些方法存在部署成本高、开发难度大、维护成本高等问题，而MCP则很好地解决了上述痛点，MCP通过大量现成的MCP Server，将常见数据源的API封装到MCP Server中，LLM引入新的数据源只需调用Server即可，接入方式变为即插即用式，使得LLM的数据集成变得简单高效。<br><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/dd668f394c19b4af749386e8a0281df4.png"></p>
<h3 id="与Function-Calling对比"><a href="#与Function-Calling对比" class="headerlink" title="与Function Calling对比"></a>与Function Calling对比</h3><p>然而在MCP之前，为了解决LLM的数据孤岛问题，openai首先引入了<code>Function Calling</code>来进行LLM的外部交互，<code>Function Calling</code> 是一个允许LLM在生成文本的过程中调用外部函数或服务的功能，看起来与MCP是很相似的。阿里云百炼里给出了<code>Function Calling</code>的流程图，通过下图可以比较清晰地理解<code>Function Calling</code> 的作用。</p>
<p>官方文档给出了<code>Function Calling</code>的定义&#x2F;功能：您可以通过<code>Function Calling</code>让模型访问您自己的自定义代码。根据系统提示和消息，模型可能会决定调用这些函数，然后，您将执行函数代码，发回结果，模型会将它们合并到最终响应中。</p>
<p><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/c1a213475c9d423f91ccc2f3455f8de7.png"></p>
<p>openai的文档给出了demo，下面代码中的tools变量包含一段描述信息，即让LLM知晓存在一个名为<code>get_weather</code>的用户自定义函数，并且写明函数所需参数等信息。运行代码，当用户提问中涉及查询天气时，LLM会尝试根据文本信息去构造符合<code>get_weather</code>要求的json，里面自然包含了<code>get_weather</code>所需参数信息（即经纬度）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">client = OpenAI()</span><br><span class="line"></span><br><span class="line">tools = [&#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;get_weather&quot;</span>,</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;Get current temperature for provided coordinates in celsius.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;parameters&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,</span><br><span class="line">        <span class="string">&quot;properties&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;latitude&quot;</span>: &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;number&quot;</span>&#125;,</span><br><span class="line">            <span class="string">&quot;longitude&quot;</span>: &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;number&quot;</span>&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;required&quot;</span>: [<span class="string">&quot;latitude&quot;</span>, <span class="string">&quot;longitude&quot;</span>],</span><br><span class="line">        <span class="string">&quot;additionalProperties&quot;</span>: <span class="literal">False</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;strict&quot;</span>: <span class="literal">True</span></span><br><span class="line">&#125;]</span><br><span class="line"></span><br><span class="line">input_messages = [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;What&#x27;s the weather like in Paris today?&quot;</span>&#125;]</span><br><span class="line"></span><br><span class="line">response = client.responses.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-4.1&quot;</span>,</span><br><span class="line">    <span class="built_in">input</span>=input_messages,</span><br><span class="line">    tools=tools,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>这里假设用户的提问触发了 <code>Function Calling</code>，LLM返回的json如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[&#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function_call&quot;</span>,</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="string">&quot;fc_12345xyz&quot;</span>,</span><br><span class="line">    <span class="string">&quot;call_id&quot;</span>: <span class="string">&quot;call_12345xyz&quot;</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;get_weather&quot;</span>,</span><br><span class="line">    <span class="string">&quot;arguments&quot;</span>: <span class="string">&quot;&#123;\&quot;latitude\&quot;:48.8566,\&quot;longitude\&quot;:2.3522&#125;&quot;</span></span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>

<p>然后自定义函数<code>get_weather</code>去处理LLM返回的json，即查询天气信息，然后返回结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tool_call = response.output[<span class="number">0</span>]</span><br><span class="line">args = json.loads(tool_call.arguments)</span><br><span class="line"></span><br><span class="line">result = get_weather(args[<span class="string">&quot;latitude&quot;</span>], args[<span class="string">&quot;longitude&quot;</span>])</span><br></pre></td></tr></table></figure>

<p>最后将结果整合到大模型中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">input_messages.append(tool_call)  <span class="comment">## append model&#x27;s function call message</span></span><br><span class="line">input_messages.append(&#123;                               <span class="comment">## append result message</span></span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function_call_output&quot;</span>,</span><br><span class="line">    <span class="string">&quot;call_id&quot;</span>: tool_call.call_id,</span><br><span class="line">    <span class="string">&quot;output&quot;</span>: <span class="built_in">str</span>(result)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">response_2 = client.responses.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-4.1&quot;</span>,</span><br><span class="line">    <span class="built_in">input</span>=input_messages,</span><br><span class="line">    tools=tools,</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response_2.output_text)</span><br></pre></td></tr></table></figure>

<p>总结上述案例，<code>Function Calling</code>就是让LLM对文本进行解析，并返回符合用户自定义函数要求的json，然后调用自定义函数得到返回结果，再交由LLM润色输出。</p>
<p>不难看出，**<code>Function Calling</code>与外界交互的核心在于自定义函数**，LLM只负责提供参数，而自定义函数需要开发人员手动编写，每个Data Source又都需要编写一个自定义函数。而MCP则是为每个数据源提供统一开源的MCP Server，Server包含了已经封装好的工具，省去了为每个数据源都编写自定义函数、处理json参数的流程，开发人员需要做的仅是接入对应的MCP Client。<br><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/36bec2b148637723165ed9d633a7d980.jpg"></p>
<h2 id="MCP-quick-start"><a href="#MCP-quick-start" class="headerlink" title="MCP quick start"></a>MCP quick start</h2><p>MCP的实现参考官方github的mcp servers，其实本质上就是Web服务。下面通过一个简单的mcp项目来快速上手mcp。</p>
<p>项目旨在构建一个本地智能舆情分析系统，输入为自然语言描述，实现自动化的新闻检索、情感分析、邮件推送功能。项目源码放到 <a target="_blank" rel="noopener" href="https://github.com/sketchpl4ne/newAnalys-mcp">Github</a>上 ，项目结构如下图所示，主要文件为：<code>server.py</code>、<code>client.py</code>、<code>.env</code>。</p>
<p>首先是<code>server.py</code>，即MCP server，主要实现三个实际功能的对应路由函数，分别是<code>search_google_news</code>、<code>analyze_sentiment</code>和<code>send_email_with_attachment</code>，每个函数接收 Client 的传参，然后去调用外部api获取响应，并返回给client。</p>
<p>其次是<code>client.py</code>，实际上是简化版本的MCP Client，即使用代码实现的一个简易的Client工具，基于官方GitHub上的<code>quickstart-resources/mcp-client-python</code>实现，包括<code>connect_to_server</code>、<code>process_query</code>、<code>plan_tool_usage</code>、<code>process_query</code>和<code>chat_loop</code>等函数，其中<code>plan_tool_usage</code>是新添函数，主要功能是实现Server端工具的顺序调用。</p>
<p>最后是<code>.env</code>，即环境变量文件，存储访问LLM、外部数据源等资源所需的api-key。<br><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/3783bd9dcddb9b9ce0f32890c7e2b95a.png"></p>
<p>输入命令<code>uv run ./client.py</code>，执行结果如下：<br><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/c6078f268f5f42035a408d23d5e25efb.png"><br><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/10073980eba815ca9155a758e22a1a63.png"><br><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/6f63e0dee568c1042b6ec94a1440fb79.png"></p>
<h2 id="How-MCP-works"><a href="#How-MCP-works" class="headerlink" title="How MCP works"></a>How MCP works</h2><p>通过详细阅读上面代码实现的Client和Server，结合下图对MCP的执行流程进行分析，流程如下：</p>
<ol>
<li>用户输入查询，经大模型处理分析，决定是否需要调用 MCP Server，需要则下一步</li>
<li>LLM将需要调用的tool_name、params交给MCP Client，Client向Server发送对应的调用请求</li>
<li>MCP Server的对应路由处理函数收到Client的请求，事先封装好的代码逻辑按照传参去获取外部数据源的数据，并返回给Client</li>
<li>Client得到Server返回的数据，再交给LLM对返回结果进行润色</li>
<li>用户得到最终输出结果</li>
</ol>
<p><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/c8ec02698451d228cd593b9e0ccc57ad.svg"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本篇文章主要介绍了MCP的入门基础知识，对MCP的定义、优缺点、使用场景进行梳理，然后通过一个具体案例来加深理解，将MCP这个抽象的概念具体化，清晰化。</p>
<p>MCP由于之前快速了解过，在其本身的理解上没有遇到太大问题，而是在MCP和Function Calling的比较上有些疑惑，因为之前并没有了解Function Calling具体实现是怎样，也就不理解为什么MCP相对Function Calling更加便捷，碰巧这一点在现成的文章都是被一笔带过的。于是，我通过阅读Openai的文档案例，明白了Function Calling是怎么回事儿，疑惑也就迎刃而解。所以，当网上没有现成的文章总结时，就应该去翻官方文档尝试自己总结，这是这次写文章总结到的经验。</p>
<p>时间有限，本文仅分析了MCP的基础概念，属于小白入门文，没有深入研究SDK代码、SSE协议等内容，这里就留到下一篇文章了，另外刚刚看到MCP+DNS重绑定攻击，同样写在下一篇文章。</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1jDVUzSEnz">https://www.bilibili.com/video/BV1jDVUzSEnz</a></li>
<li><a target="_blank" rel="noopener" href="https://modelcontextprotocol.io/">https://modelcontextprotocol.io</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/modelcontextprotocol/quickstart-resources">https://github.com/modelcontextprotocol/quickstart-resources</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.logto.io/zh-CN/what-is-mcp">https://blog.logto.io/zh-CN/what-is-mcp</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/27327515233">https://zhuanlan.zhihu.com/p/27327515233</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/29001189476">https://zhuanlan.zhihu.com/p/29001189476</a></li>
<li><a target="_blank" rel="noopener" href="https://help.aliyun.com/zh/model-studio/qwen-function-calling">https://help.aliyun.com/zh/model-studio/qwen-function-calling</a></li>
</ul>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/sketchpl4ne">Projects</a></li>
        
          <li><a href="/HTML/links.html">links</a></li>
        
          <li><a href="/HTML/about.html">About</a></li>
        
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#what-is-MCP"><span class="toc-number">1.</span> <span class="toc-text">what is MCP?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89"><span class="toc-number">1.1.</span> <span class="toc-text">定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6"><span class="toc-number">1.3.</span> <span class="toc-text">通信机制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Why-MCP"><span class="toc-number">2.</span> <span class="toc-text">Why MCP?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E4%BC%A0%E7%BB%9FLLM%E5%AF%B9%E6%AF%94"><span class="toc-number">2.1.</span> <span class="toc-text">与传统LLM对比</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8EFunction-Calling%E5%AF%B9%E6%AF%94"><span class="toc-number">2.2.</span> <span class="toc-text">与Function Calling对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MCP-quick-start"><span class="toc-number">3.</span> <span class="toc-text">MCP quick start</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-MCP-works"><span class="toc-number">4.</span> <span class="toc-text">How MCP works</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">6.</span> <span class="toc-text">Reference</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://jaspersec.top/posts/3469218162.html"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://jaspersec.top/posts/3469218162.html&text=MCP基础知识"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://jaspersec.top/posts/3469218162.html&title=MCP基础知识"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://jaspersec.top/posts/3469218162.html&is_video=false&description=MCP基础知识"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=MCP基础知识&body=Check out this article: https://jaspersec.top/posts/3469218162.html"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://jaspersec.top/posts/3469218162.html&title=MCP基础知识"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://jaspersec.top/posts/3469218162.html&title=MCP基础知识"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://jaspersec.top/posts/3469218162.html&title=MCP基础知识"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://jaspersec.top/posts/3469218162.html&title=MCP基础知识"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://jaspersec.top/posts/3469218162.html&name=MCP基础知识&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://jaspersec.top/posts/3469218162.html&t=MCP基础知识"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    Jasper_sec
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/sketchpl4ne">Projects</a></li><!--
     --><!--
       --><li><a href="/HTML/links.html">links</a></li><!--
     --><!--
       --><li><a href="/HTML/about.html">About</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
      <ul>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span id="busuanzi_container_site_pv">
          本站总访问量 <span id="busuanzi_value_site_pv"></span>次
        </span>
        <span id="busuanzi_container_site_uv">
          本站访客数 <span id="busuanzi_value_site_uv"></span>人
        </span>
        <span id="busuanzi_container_page_uv">
          本页访问量 <span id="busuanzi_value_page_pv"><!-- number will be auto injected here by busuanzi --></span>次
        </span>
      </ul>
    </nav>
  </div>

</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?21e6754c7f372c2de41518ffb4f72c33";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>

<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="CodeQL 概览CodeQL是一个静态代码分析引擎，用来给半自动化检查代码中可能存在的漏洞和bug。使用 CodeQL 进行代码审计包括下面三个步骤：  从源代码中提取必备信息，然后创建 codeql 数据库 用他人编写好 or 自定义的 ql 语句进行查询 解释分析查询结果  创建数据库创建数据库通常使用固定的命令： 1codeql database create &#x2F;codeql-dbs&#x2F;ex">
<meta property="og:type" content="article">
<meta property="og:title" content="CodeQL 基础">
<meta property="og:url" content="https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="Jasper_sec">
<meta property="og:description" content="CodeQL 概览CodeQL是一个静态代码分析引擎，用来给半自动化检查代码中可能存在的漏洞和bug。使用 CodeQL 进行代码审计包括下面三个步骤：  从源代码中提取必备信息，然后创建 codeql 数据库 用他人编写好 or 自定义的 ql 语句进行查询 解释分析查询结果  创建数据库创建数据库通常使用固定的命令： 1codeql database create &#x2F;codeql-dbs&#x2F;ex">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/9e615ac872577ad8d2ec0cde0f94502a.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/b70fb9bfc11b6534e91c06e6d9f045eb.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/a82ac657b9b2f45af73a256c789aad21.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/8b9b95419c6a0d400e200499bb22c15b.png">
<meta property="og:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/1badbf9fb56b109f82a2981123d71359.png">
<meta property="article:published_time" content="2024-07-01T10:31:53.000Z">
<meta property="article:modified_time" content="2025-03-31T20:53:38.530Z">
<meta property="article:author" content="Jasper_sec">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="代码审计">
<meta property="article:tag" content="codeql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/9e615ac872577ad8d2ec0cde0f94502a.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>CodeQL 基础</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/sketchpl4ne">Projects</a></li><!--
     --><!--
       --><li><a href="/links/">links</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </span> 
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/08/21/0x14%20%E6%9F%90v10%20channel%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20%E5%87%BA%E7%BD%91%E9%80%9A%E6%9D%80/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/05/25/0x11%20CISCN2024%20writeup/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&text=CodeQL 基础"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&title=CodeQL 基础"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&is_video=false&description=CodeQL 基础"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CodeQL 基础&body=Check out this article: https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&title=CodeQL 基础"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&title=CodeQL 基础"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&title=CodeQL 基础"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&title=CodeQL 基础"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&name=CodeQL 基础&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&t=CodeQL 基础"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <!-- 
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#CodeQL-%E6%A6%82%E8%A7%88"><span class="toc-number">1.</span> <span class="toc-text">CodeQL 概览</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.1.</span> <span class="toc-text">创建数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E7%BC%96%E8%AF%91%E5%9E%8B%E8%AF%AD%E8%A8%80"><span class="toc-number">1.1.1.</span> <span class="toc-text">非编译型语言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%9E%8B%E8%AF%AD%E8%A8%80"><span class="toc-number">1.1.2.</span> <span class="toc-text">编译型语言</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.2.</span> <span class="toc-text">执行查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C"><span class="toc-number">1.3.</span> <span class="toc-text">查询结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CodeQL-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-number">2.</span> <span class="toc-text">CodeQL 快速入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%88%8F%E4%BE%8B%E5%AD%90"><span class="toc-number">2.1.</span> <span class="toc-text">游戏例子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E4%BE%8B%E5%AD%90"><span class="toc-number">2.2.</span> <span class="toc-text">实际例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CodeQL-%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="toc-number">3.</span> <span class="toc-text">CodeQL 参考文档</span></a></li></ol>
      </div>
     -->
    <div id="toc">
      <div id="toc-div" class="toc-article" >
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#CodeQL-%E6%A6%82%E8%A7%88"><span class="toc-number">1.</span> <span class="toc-text">CodeQL 概览</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.1.</span> <span class="toc-text">创建数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E7%BC%96%E8%AF%91%E5%9E%8B%E8%AF%AD%E8%A8%80"><span class="toc-number">1.1.1.</span> <span class="toc-text">非编译型语言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%9E%8B%E8%AF%AD%E8%A8%80"><span class="toc-number">1.1.2.</span> <span class="toc-text">编译型语言</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.2.</span> <span class="toc-text">执行查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C"><span class="toc-number">1.3.</span> <span class="toc-text">查询结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CodeQL-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-number">2.</span> <span class="toc-text">CodeQL 快速入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%88%8F%E4%BE%8B%E5%AD%90"><span class="toc-number">2.1.</span> <span class="toc-text">游戏例子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E4%BE%8B%E5%AD%90"><span class="toc-number">2.2.</span> <span class="toc-text">实际例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CodeQL-%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="toc-number">3.</span> <span class="toc-text">CodeQL 参考文档</span></a></li></ol>
        
      </div>
    </div>
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        CodeQL 基础
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Jasper_sec</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-07-01T10:31:53.000Z" class="dt-published" itemprop="datePublished">2024-07-01</time>
        
        (Updated: <time datetime="2025-03-31T20:53:38.530Z" class="dt-updated" itemprop="dateModified">2025-04-01</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Java/" rel="tag">Java</a>, <a class="p-category" href="/tags/codeql/" rel="tag">codeql</a>, <a class="p-category" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" rel="tag">代码审计</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="CodeQL-概览"><a href="#CodeQL-概览" class="headerlink" title="CodeQL 概览"></a>CodeQL 概览</h2><p>CodeQL是一个静态代码分析引擎，用来给半自动化检查代码中可能存在的漏洞和bug。使用 CodeQL 进行代码审计包括下面三个步骤：</p>
<ol>
<li>从源代码中提取必备信息，然后创建 codeql 数据库</li>
<li>用他人编写好 or 自定义的 ql 语句进行查询</li>
<li>解释分析查询结果</li>
</ol>
<h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><p>创建数据库通常使用固定的命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create /codeql-dbs/example-repo --language=&lt;language-label&gt; --source-root /checkouts/example-repo</span><br></pre></td></tr></table></figure>

<p>当然不同语言存在差异，可以以编译型 &#x2F; 非编译型进行区分，可以参考：<a target="_blank" rel="noopener" href="https://docs.github.com/zh/code-security/codeql-cli/getting-started-with-the-codeql-cli/preparing-your-code-for-codeql-analysis">为 CodeQL 分析准备代码</a></p>
<h4 id="非编译型语言"><a href="#非编译型语言" class="headerlink" title="非编译型语言"></a>非编译型语言</h4><p>非编译型语言构成的项目，其数据库的构建方式通常比较简单，指定源码文件夹和输出文件夹即可。</p>
<p>Javascript 和 typescript 项目</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create --language=javascript-typescript --source-root &lt;folder-to-extract&gt; &lt;output-folder&gt;/javascript-database</span><br></pre></td></tr></table></figure>

<p>Python 项目</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create --language=python &lt;output-folder&gt;/python-database</span><br></pre></td></tr></table></figure>

<p>Rubu 项目</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create --language=ruby --source-root &lt;folder-to-extract&gt; &lt;output-folder&gt;/ruby-database</span><br></pre></td></tr></table></figure>

<h4 id="编译型语言"><a href="#编译型语言" class="headerlink" title="编译型语言"></a>编译型语言</h4><p>编译型语言的数据库构建相对复杂，因为项目需要先进行编译，然后生成最终的项目，而不同的项目可以使用不同的构建工具进行管理，所以这一块比较复杂。</p>
<p>codeql-cli 提供了两种思路，一是自动识别进行数据库生成， 二是显式指定生成最终项目的命令，既项目构建的命令。</p>
<p>例如，自动构建 C++ &#x2F; C 项目的数据库的命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create --language=cpp &lt;output-folder&gt;/cpp-database</span><br></pre></td></tr></table></figure>

<p>而显式指定构建项目的命令来生成 C &#x2F; C++项目的数据库的命令如下，多一个参数而已：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create cpp-database --language=c-cpp --command=make</span><br></pre></td></tr></table></figure>

<p>显式指定构建命令生成 C## 项目数据库：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create csharp-database --language=csharp --command=&#x27;dotnet build /t:rebuild&#x27;</span><br></pre></td></tr></table></figure>

<p>显式 指定环境变量 &#x2F; 指定构建脚本 生成 Go 项目数据库：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CODEQL_EXTRACTOR_GO_BUILD_TRACING=on codeql database create go-database --language=go</span><br><span class="line"></span><br><span class="line">codeql database create go-database --language=go --command=&#x27;./scripts/build.sh&#x27;</span><br></pre></td></tr></table></figure>

<p>显示指定 maven 生成 Java 项目数据库：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create java-database --language=java-kotlin --command=&#x27;mvn clean install&#x27;</span><br></pre></td></tr></table></figure>

<p>显示指定 Ant 生成 Java 项目数据库：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create java-database --language=java-kotlin --command=&#x27;ant -f build.xml&#x27;</span><br></pre></td></tr></table></figure>
<h3 id="执行查询"><a href="#执行查询" class="headerlink" title="执行查询"></a>执行查询</h3><p>创建完数据库之后，在 vscode 的插件里按文件夹导入，即可创建 ql 脚本，执行查询操作。<br><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/9e615ac872577ad8d2ec0cde0f94502a.png"></p>
<h3 id="查询结果"><a href="#查询结果" class="headerlink" title="查询结果"></a>查询结果</h3><p>类似 sql 查询，通过 运行 ql 语句进行查询操作，同时返回一个结果集，包含符合 ql 语句要求的代码片段。<br><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/b70fb9bfc11b6534e91c06e6d9f045eb.png"></p>
<h2 id="CodeQL-快速入门"><a href="#CodeQL-快速入门" class="headerlink" title="CodeQL 快速入门"></a>CodeQL 快速入门</h2><p>首先是环境搭建，官方文档推荐使用 vscode extension，本质就是下面三步走：</p>
<ul>
<li>下载 codeql-cli 和 packs 的<a target="_blank" rel="noopener" href="https://github.com/github/codeql-action/releases">捆绑包</a>，并配置好环境变量</li>
<li>vscode 安装 CodeQL 插件，并在 vscode extension settings 里配置好 codeql-cli 的路径</li>
<li>下载 <a target="_blank" rel="noopener" href="https://github.com/github/vscode-codeql-starter/">vscode-codeql-starter workspace</a>，双击 <code>vscode-codeql-starter.code-workspace</code>打开 workspace</li>
</ul>
<h3 id="游戏例子"><a href="#游戏例子" class="headerlink" title="游戏例子"></a>游戏例子</h3><p>官方文档里，通过游戏例子帮助入门： <a target="_blank" rel="noopener" href="https://codeql.github.com/docs/writing-codeql-queries/ql-tutorials/">https://codeql.github.com/docs/writing-codeql-queries/ql-tutorials/</a></p>
<p>例-01：find the thief</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span> See https:<span class="operator">/</span><span class="operator">/</span>codeql.github.com<span class="operator">/</span>docs<span class="operator">/</span>writing<span class="operator">-</span>codeql<span class="operator">-</span>queries<span class="operator">/</span>ql<span class="operator">-</span>tutorials<span class="operator">/</span>#ql<span class="operator">-</span>tutorials.</span><br><span class="line">import tutorial</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Person t</span><br><span class="line"><span class="keyword">where</span> t.getHeight() <span class="operator">&gt;</span> <span class="number">150</span></span><br><span class="line">    <span class="keyword">and</span> t.getHairColor() <span class="operator">!=</span> &quot;blond&quot;</span><br><span class="line">    <span class="keyword">and</span> <span class="keyword">exists</span>( string c <span class="operator">|</span> t.getHairColor() <span class="operator">=</span> c)</span><br><span class="line">    <span class="keyword">and</span> <span class="keyword">not</span> t.getAge() <span class="operator">&lt;</span> <span class="number">30</span></span><br><span class="line">    <span class="keyword">and</span> t.getLocation() <span class="operator">=</span> &quot;east&quot;</span><br><span class="line">    <span class="keyword">and</span> (t.getHairColor() <span class="operator">=</span> &quot;brown&quot; <span class="keyword">or</span> t.getHairColor() <span class="operator">=</span> &quot;black&quot;)</span><br><span class="line">    <span class="keyword">and</span> <span class="keyword">not</span> (t.getHeight() <span class="operator">&gt;</span> <span class="number">180</span> <span class="keyword">and</span> t.getHeight() <span class="operator">&lt;</span> <span class="number">190</span>)</span><br><span class="line">    <span class="keyword">and</span> <span class="keyword">not</span> forall(Person p <span class="operator">|</span> t.getAge() <span class="operator">&gt;</span> p.getAge())</span><br><span class="line">    <span class="keyword">and</span> t <span class="operator">!=</span> <span class="built_in">max</span>(Person p <span class="operator">|</span> <span class="operator">|</span> p <span class="keyword">order</span> <span class="keyword">by</span> p.getHeight())</span><br><span class="line">    <span class="keyword">and</span> t.getHeight() <span class="operator">&lt;</span> <span class="built_in">avg</span>(Person p <span class="operator">|</span>  <span class="operator">|</span>p.getHeight())</span><br><span class="line">    <span class="keyword">and</span> t <span class="operator">=</span> <span class="built_in">max</span>(Person p <span class="operator">|</span>p.getLocation()<span class="operator">=</span>&quot;east&quot;<span class="operator">|</span> p <span class="keyword">order</span> <span class="keyword">by</span> p.getAge())</span><br><span class="line"><span class="keyword">select</span> t</span><br></pre></td></tr></table></figure>

<p>例-02：Catch the fire starter</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import tutorial</span><br><span class="line"></span><br><span class="line">predicate isSouthern(Person p) &#123;</span><br><span class="line">    p.getLocation() <span class="operator">=</span> &quot;south&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">predicate isBald(Person p) &#123;</span><br><span class="line">    <span class="keyword">not</span> <span class="keyword">exists</span>(string c <span class="operator">|</span> p.getHairColor() <span class="operator">=</span> c )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Southerner extends Person &#123;</span><br><span class="line">    Southerner() &#123; isSouthern(this) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Child extends Person&#123;</span><br><span class="line">    Child()&#123;this.getAge() <span class="operator">&lt;</span> <span class="number">10</span>&#125;</span><br><span class="line"></span><br><span class="line">    override predicate isAllowedIn(string region) &#123;</span><br><span class="line">        region <span class="operator">=</span> this.getLocation()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Southerner s</span><br><span class="line"><span class="keyword">where</span> s.isAllowedIn(&quot;north&quot;) </span><br><span class="line">    <span class="keyword">and</span> isBald(s)</span><br><span class="line"><span class="keyword">select</span> s, s.getAge()</span><br></pre></td></tr></table></figure>

<p>例-03：Crown the rightful heir</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import tutorial</span><br><span class="line"></span><br><span class="line">Person childOf(Person p) &#123;</span><br><span class="line">    p <span class="operator">=</span> parentOf(<span class="keyword">result</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person ancestorOf(Person p)&#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> parentOf(p) <span class="keyword">or</span></span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> parentOf(ancestorOf(p))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person relativeOf(Person p)&#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> childOf<span class="operator">*</span>(ancestorOf(p)) <span class="keyword">and</span> <span class="keyword">not</span> result.isDeceased()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person isATheif(Person t)&#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> t </span><br><span class="line">    <span class="keyword">and</span> t.getHeight() <span class="operator">&gt;</span> <span class="number">150</span></span><br><span class="line">    <span class="keyword">and</span> t.getHairColor() <span class="operator">!=</span> &quot;blond&quot;</span><br><span class="line">    <span class="keyword">and</span> <span class="keyword">exists</span>( string c <span class="operator">|</span> t.getHairColor() <span class="operator">=</span> c)</span><br><span class="line">    <span class="keyword">and</span> <span class="keyword">not</span> t.getAge() <span class="operator">&lt;</span> <span class="number">30</span></span><br><span class="line">    <span class="keyword">and</span> t.getLocation() <span class="operator">=</span> &quot;east&quot;</span><br><span class="line">    <span class="keyword">and</span> (t.getHairColor() <span class="operator">=</span> &quot;brown&quot; <span class="keyword">or</span> t.getHairColor() <span class="operator">=</span> &quot;black&quot;)</span><br><span class="line">    <span class="keyword">and</span> <span class="keyword">not</span> (t.getHeight() <span class="operator">&gt;</span> <span class="number">180</span> <span class="keyword">and</span> t.getHeight() <span class="operator">&lt;</span> <span class="number">190</span>)</span><br><span class="line">    <span class="keyword">and</span> <span class="keyword">not</span> forall(Person p <span class="operator">|</span> t.getAge() <span class="operator">&gt;</span> p.getAge())</span><br><span class="line">    <span class="keyword">and</span> t <span class="operator">!=</span> <span class="built_in">max</span>(Person p <span class="operator">|</span> <span class="operator">|</span> p <span class="keyword">order</span> <span class="keyword">by</span> p.getHeight())</span><br><span class="line">    <span class="keyword">and</span> t.getHeight() <span class="operator">&lt;</span> <span class="built_in">avg</span>(Person p <span class="operator">|</span>  <span class="operator">|</span>p.getHeight())</span><br><span class="line">    <span class="keyword">and</span> t <span class="operator">=</span> <span class="built_in">max</span>(Person p <span class="operator">|</span>p.getLocation()<span class="operator">=</span>&quot;east&quot;<span class="operator">|</span> p <span class="keyword">order</span> <span class="keyword">by</span> p.getAge())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person isAFireStarter(Person f)&#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> f </span><br><span class="line">    <span class="keyword">and</span> f.getLocation() <span class="operator">=</span> &quot;south&quot;</span><br><span class="line">    <span class="keyword">and</span> <span class="keyword">not</span> f.getAge() <span class="operator">&lt;</span> <span class="number">10</span></span><br><span class="line">    <span class="keyword">and</span> <span class="keyword">not</span> <span class="keyword">exists</span>(string c <span class="operator">|</span> f.getHairColor() <span class="operator">=</span> c )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person hasCriminalRecord(Person p)&#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> isAFireStarter(p) <span class="keyword">or</span></span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> isATheif(p)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Person p</span><br><span class="line"><span class="keyword">where</span> p <span class="operator">=</span> relativeOf(&quot;King Basil&quot;)</span><br><span class="line">    <span class="keyword">and</span> <span class="keyword">not</span> p <span class="operator">=</span> hasCriminalRecord(p)</span><br><span class="line"><span class="keyword">select</span> p <span class="operator">+</span> &quot; You are the next king!&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>例-04：Cross the river，这个偏算法思想，不看。</p>
<h3 id="实际例子"><a href="#实际例子" class="headerlink" title="实际例子"></a>实际例子</h3><p>以 java-sec-code 项目为例，创建数据库命令的命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create /Users/jasper/Documents/Security/tools/CodeQL/databases/java-sec-code-database --language=java --source-root=/Users/jasper/Documents/Security/java/java-sec-code --command=&quot;mvn clean package&quot;</span><br></pre></td></tr></table></figure>

<p>点侧栏点CodeQL插件，选Java -&gt; 导入上面创建的数据库 -&gt; 运行example.ql，能正常运行输出结果说明环境正常。<br><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/a82ac657b9b2f45af73a256c789aad21.png"></p>
<p>再以 activemq 为例，注意 maven build 需要科学上网，源码是直接在 activmq GitHub clone 的。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create .\codeql-databases\activemq --language=java-kotlin --source-root .\activemq-activemq-6.1.5\ --command=&#x27;mvn clean install -Dmaven.test.skip=true&#x27;</span><br></pre></td></tr></table></figure>

<p>编写查询，查找 activemq 项目里所有调用了 <code>.equals(&quot;&quot;)</code> 的函数，并且调用 该 <code>equals()</code> 的对象的类型应为  String</p>
<p>注意：官方文档上 MethodAccess 已经弃用，MethodAccess 改名为 MehtodCall，MehtodCall.getMethod()获取到的是被调用的函数，即 <code>callee</code>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import java</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> MethodCall mc</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">    mc.getMethod().hasName(&quot;equals&quot;) <span class="keyword">and</span></span><br><span class="line">    mc.getArgument(<span class="number">0</span>).(StringLiteral).getValue() <span class="operator">=</span> &quot;&quot; <span class="keyword">and</span></span><br><span class="line">    mc.getQualifier().getType() instanceof TypeString</span><br><span class="line"><span class="keyword">select</span> mc, &quot;This comparison to empty string is inefficient, use isEmpty() instead.&quot;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/8b9b95419c6a0d400e200499bb22c15b.png"></p>
<p>再例如，创建一个 python 项目的 codeql-database 命令如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create ./salt-codeql-database --language=python --source-root ./salt-master</span><br></pre></td></tr></table></figure>

<p>再写入如下 ql 语句，查找函数参数数量大于7的函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import python</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> <span class="keyword">Function</span> f</span><br><span class="line"><span class="keyword">where</span> <span class="built_in">count</span>(f.getAnArg()) <span class="operator">&gt;</span> <span class="number">7</span></span><br><span class="line"><span class="keyword">select</span> f</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/sketchpl4ne/images/main/imgs/1badbf9fb56b109f82a2981123d71359.png"></p>
<h2 id="CodeQL-参考文档"><a href="#CodeQL-参考文档" class="headerlink" title="CodeQL 参考文档"></a>CodeQL 参考文档</h2><ol>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/codeql-language-guides/codeql-for-java/">codeql for java</a>：在 Java 项目中进行简单的 CodeQL 查询，常用的类都有一些例子，具备参考价值。</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/">QL language reference</a> ：QL 查询语言教程，列举了 Predicates、Types 等类的广义用法，比上面的更全面。</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/codeql-standard-libraries/java/">standard librares for java</a> ：有关 codeql for java 的所有类和方法的文档，过于全面。</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/codeql-query-help/java-cwe/">CWE for Java</a> ： 漏洞扫描脚本，包括 JNDI、log4j等，可作为查询编写的参考，在 <code>java-queries/securiy</code> 目录下。</li>
</ol>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/sketchpl4ne">Projects</a></li>
        
          <li><a href="/links/">links</a></li>
        
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#CodeQL-%E6%A6%82%E8%A7%88"><span class="toc-number">1.</span> <span class="toc-text">CodeQL 概览</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.1.</span> <span class="toc-text">创建数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E7%BC%96%E8%AF%91%E5%9E%8B%E8%AF%AD%E8%A8%80"><span class="toc-number">1.1.1.</span> <span class="toc-text">非编译型语言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%9E%8B%E8%AF%AD%E8%A8%80"><span class="toc-number">1.1.2.</span> <span class="toc-text">编译型语言</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.2.</span> <span class="toc-text">执行查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C"><span class="toc-number">1.3.</span> <span class="toc-text">查询结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CodeQL-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-number">2.</span> <span class="toc-text">CodeQL 快速入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%88%8F%E4%BE%8B%E5%AD%90"><span class="toc-number">2.1.</span> <span class="toc-text">游戏例子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E4%BE%8B%E5%AD%90"><span class="toc-number">2.2.</span> <span class="toc-text">实际例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CodeQL-%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="toc-number">3.</span> <span class="toc-text">CodeQL 参考文档</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&text=CodeQL 基础"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&title=CodeQL 基础"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&is_video=false&description=CodeQL 基础"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CodeQL 基础&body=Check out this article: https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&title=CodeQL 基础"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&title=CodeQL 基础"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&title=CodeQL 基础"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&title=CodeQL 基础"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&name=CodeQL 基础&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://jaspersec.top/2024/07/01/0x17%20CodeQL%20%E5%9F%BA%E7%A1%80/&t=CodeQL 基础"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    Jasper_sec
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/sketchpl4ne">Projects</a></li><!--
     --><!--
       --><li><a href="/links/">links</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
      <ul>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span id="busuanzi_container_site_pv">
          本站总访问量 <span id="busuanzi_value_site_pv"></span>次
        </span>
        <span id="busuanzi_container_site_uv">
          本站访客数 <span id="busuanzi_value_site_uv"></span>人
        </span>
        <span id="busuanzi_container_page_uv">
          本页访问量 <span id="busuanzi_value_page_pv"><!-- number will be auto injected here by busuanzi --></span>次
        </span>
      </ul>
    </nav>
  </div>

</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?21e6754c7f372c2de41518ffb4f72c33";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
